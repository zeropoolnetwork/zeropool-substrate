use crate::mock::*;
use frame_support::{assert_err, assert_ok};
use hex_literal::hex;
use sp_core::crypto::AccountId32;

// Prebuilt transactions for the testing mnemonic (test * 11 junk)

// deposit 3000000000
// 0x00000000281879554ace64fedf59ee5fd2c57b6d3a2b86a3ca0a263615c10a729a17d76018e818c5e0bf508504f702688537fbd0aefc2501aa16420564914118f6930e25000000000000000000000000000000000000000000000000002dc6c010d64987a633c0a7024142432a63869d8b55e1854a84fce07b42dd5d5ecb212e2bf800d95099fb334d7287a6a14d680f089dcbcca80fb60bfbf54c29892faadc1072aa5bf487f6edc89693ad55b96494256ff17fd72d301c6f63273a0c1ac97427b79744dd18830eb7b82aa757bf51655c42d921b39ec3f9253452886b3fc6811c642f67b3101e70820bcbe959aa2cbd7e98c24110f9da2e20c457b19e74f031269a8748132f4b54d5a969dad6caaeca880f91b43bf3df9b93584926e222a14f24c53d543f24ef4f2aee94a1ee65a9db2961d00eb3e9ca3bba86954d95a64ff5294d3907ee89b49052e5c7dd9f201f1564d54f48e0675a51be85a29108010b451f73faf276e945be7e2d8b7a63dfd502701cda709b5614f5e748b899baf4645c0f576e761adb25689474e5a482f6d0287d543f3a0e63eb21650c3c5ac6eeaa2717f8661d4725098b4dfb31a5605a479801885421dbb83e632d5117e27f0e06b9186729a664e9b1e16cedf52d10b9360e1ec0f9b9671d32333b03e9f11f696ef516173a857cfb5becffab6e6f2e25f1c30301fc9e06c739e8ea359f39c926a8660b116bbe0c89fa5d6d57d68626acea95710ffd2e6ca10bd4f61e44520d4ec54e263fd4a40d608afa1e258dfdc9e11b3572f61609f8cd33ccb0ad99d48192816e0af394205b48af69bfb700d815334def2f382745bc576e8c311a5aa8b92b44732f2711d6aeb76ab5548ca258b726eb9e9cd169be6ddb0d192a5d415f80746133000000d2000000000000000001000000fc7b3e3cc3d8b3026a04d6a239e65cf636b943458b0ad73563ab198633f3b12825e6cab496554fe315a85be40b6d26311620785110394b25de1c92a7ab3b02168ff62cf8d8bac650d8270cf6824806e0bd744b3e3fcc1b0eef8fb4628175eb473af6de862fc2c4b6ba07487d692539cb836109675a89601817b8c78474e2b7b7eb6a35f07592935ba71b923292b8f6b65aa4647b74305bff97073dc0ec2224fe4f6fcc1cd3faa048459d253ae9935b89939516c28ed11b966baa667619cfdcc2d5688eb742ead000ac5048ae858aca2e6aa43e00661562a47026fe88ff83992430204a159752c8335b630922a0c9dcfa6e4897abecafa3fa8dcd6bb624ef741e843522d34c4a3d547f4a26577c7300f955aeea36d65a9486b3e574f60d8203ee83a9073b288b

// transfer 1000000000 to self
// 0x00000000237d9ab8ca165b7728b5353ee84423ee3ee44a71c535894a08dc2c476be4c321179204c43f1f98e74eab0c9e668c6e63bdb16907443a977e323dd3023602fb6e000000000080000000000000000000000000000000000000000000002d10fca86c5f882296870b3cee750134cc5af7fd10b5df5fe0c7b1a465b478b829e384af859d777e7ebf339ae7c21bc45bbe2da588d9af5f4f1b556f9a3263232af3fab5aa4f0df62236ecb7938482c862a32207aa397aa0ba0fae47841802e111af294acf087e6cdb385c944eb997a18154fbea9c3f4c34b98517d062ce664321c65349a1070a08a6824a195ca4ccc8f3a4ee73f4d55ce19ec626513b5684772df66f128fbfeadb4c43afa8b0133c0c98872d2f07fbd5d9abdaf6a7434ee227112747c3e3ab974996366e183cbba0dc98cbdb50b6f8f68832924695475a49c908123f64dde854f360a3a5ff30fe0802d9b26cf931f3d1356527efc9f240cc0229099ed53518664aa52c9cdeb77ebbea7616fa25506073d8d29162e5c73b916105d6c07495bdd93eb60a3dff79771a88baba6e7ad3f4bb4855e18bba78226f2b0f2db408d145faf5835fd11d6a12a18e159ffc4869b398849239259cd5f6b0a61d86ec7af5dad43bfccb9d20d4a9dc0b004760c8b7683bf3147783b1d4d2603c19a0829f443e907797acbda88bd31f67646b509ff2636fa554b4e30d95e3fff527f9cbce3cbaa8a58ad74ea2d1d549e2cfa2b8cd46a7ded72c39e6b752cf3a2f271fdb02f7e34d938bd5fe16d60786faa1addb87eabc153ad161eeaccf247d8e2a5aac24078162d70963760ca6221d35b00a41f9fe6643facb8ddac452a4fc8402dfa64efc00b497fc81884cc4820060b3fb809852d8445493c256ade00024070001017e0000000000000000020000002dedb8d83de8fd17b97a0c511bd8dfcbbf5a857c34c60c7b429d4dbf811aae28f627302e3a6384d3b7b97d571e9ccb8651f2405febfd9596bece416900684417730f108b1f1edba449c5a75cc27e4cf8486ea2a883561b1667ea1cd338eff42fae7b03ffdbafc43c8f2f3cea96cef62584bcda71768439882b78926602d20ac3523734ad517e701319d3984967ff6601760a726ef1d6b18476338ba321b0fd88088062ba8b8b78c751863c574a9618f4598c43d314f290bb3ee40a11a632600c34871f184450c7306e6904f4e737505043aed92bfa356689ce706a70d7ce8ac80d65a0a2877e36e980aad643b6423ae12ef414f665c018de9e15d0f03b9e3351cd55a134e8c0e8bd1cf8a37126f31f50f8a492d6f1c737bf81e1af3f98b300691c76983003053091f2007a0dce6bfa90c0219d78ce02ea0e05299565f5a9e2a4cf1347dc3ac33488f165f04f0171ca0070fd1fe19aeec1ce1ecbf306167cd09151f181b4be4c1e7e93bb4f430863333eab18

// withdraw 3000000000
// 0x000000002c985dbf440ba5d71866be3aab012bc487f32daf57f912c9efe3badd920c63db07b95d4d84ff468f72c226f8e0cec59e6f8d0b2af55a4a99f0c4335df79308840000000001000000000000000000000000000000ffffffffffd239401e76605d181bf056f5db4aeea7ab11f6f998cea56427fee2e0ab17e5f0593a701df6a9fec0f64939ddf60bc3a1a06a161074f30b97ffcdca95fb2082affae1ed08b0b51ccef92b2d29117c26f8471dc86db8f650b995eaeec4648ddded95a8650297b462124bc86c3f6875ebfd7c95860a7e6cb12041ca8eeb434f5c96f296b601548f068ce0d1d14e6a00f3866a32083bdce217480705c336a177ecac8295b712bbf5b47fb2475672c19e2f79429b668a815c18dfdbf569bc3031a8b97038a61a87c42985b6fad4c846320f8a02e0bf8defb9adfb4ba61213c32969cd8f0bad0690a04fdc795a4fa481784d39dd9b8e5e65db3247c3039a8b6864416cd562bb1216a80df8beb5b525f72c5d33640d4eadd0fe25faff6ab9d4302e1866876e7b0012b14735565d70674622aa29e7a16f4abf5c263c6f013eabb74955b66f12a4130ddda82bd8054d0768290629178f041cb97473fea93f9af3fc1af9b4c4667721c426b74da384c7c305b3a1db26687dc4f1ff1e914bb7b6aed2681c50e762a41dfe9e0e28c3e6625fcdb4cecd2b180d584214c5d3bb810890eba26ec3daf6c5142fea4c03b570a5690199cd71b0d1b3ccdcdef666ed9ddf6ada0b8803568aaa12af788940c776ed416e8f8171efbca512e835bc7d21bde98392436209657acc2015cc37828dc572a319e1ab69c0375281dc9834b604e04b07b796bbfa14418b09b3a8f848d37fc8a341b31a285945fdb6a33534fa76e15dffd65dd26728cec6000200fa00000000000000000000000000000000d000ac5048ae858aca2e6aa43e00661562a47026fe88ff83992430204a1597520100000002e3e0d869ad18376d317b73d4d56aeca73ec5eb2b8b43216a920e79403fae0783621edf3a8435f9be5acad4a0d945007be6b6131a6fe40333dea8f479511f02d56165f76d4fb9fc8a893e96744cab0801af7bc884afb4c9a20da401f7520ba10d68c950a097a96b3722bad97cc4d51998d02188d2fd74915e82e856559a03c0bc2f24a38ff500254f70923a5ffd8ce7843da20330db7057283de00ad2c663bc449b2d4d3e64dd66d22a42b8aaeddfae65a5b7714b069ca62ab37fac682a26437eaf4f81daa8

const OWNER: AccountId32 = AccountId32::new(hex_literal::hex!(
    "d000ac5048ae858aca2e6aa43e00661562a47026fe88ff83992430204a159752"
));

fn owner() -> Origin {
    Origin::signed(OWNER)
}

fn init_state() {
    let transfer_vk = std::fs::read("../../js/params/transfer_verification_key.bin")
        .expect("download and place the params directory into the js directory");
    assert_ok!(Zeropool::set_transfer_vk(owner(), transfer_vk));

    let tree_vk = std::fs::read("../../js/params/tree_verification_key.bin")
        .expect("download and place the params directory into the js directory");
    assert_ok!(Zeropool::set_tree_vk(owner(), tree_vk));

    assert_ok!(ZeropoolOperatorManager::set_operator(owner(), OWNER));
}

#[test]
fn test_transact_full_cycle() {
    new_test_ext().execute_with(|| {
        init_state();

        let deposit = hex!["00000000281879554ace64fedf59ee5fd2c57b6d3a2b86a3ca0a263615c10a729a17d76018e818c5e0bf508504f702688537fbd0aefc2501aa16420564914118f6930e25000000000000000000000000000000000000000000000000002dc6c010d64987a633c0a7024142432a63869d8b55e1854a84fce07b42dd5d5ecb212e2bf800d95099fb334d7287a6a14d680f089dcbcca80fb60bfbf54c29892faadc1072aa5bf487f6edc89693ad55b96494256ff17fd72d301c6f63273a0c1ac97427b79744dd18830eb7b82aa757bf51655c42d921b39ec3f9253452886b3fc6811c642f67b3101e70820bcbe959aa2cbd7e98c24110f9da2e20c457b19e74f031269a8748132f4b54d5a969dad6caaeca880f91b43bf3df9b93584926e222a14f24c53d543f24ef4f2aee94a1ee65a9db2961d00eb3e9ca3bba86954d95a64ff5294d3907ee89b49052e5c7dd9f201f1564d54f48e0675a51be85a29108010b451f73faf276e945be7e2d8b7a63dfd502701cda709b5614f5e748b899baf4645c0f576e761adb25689474e5a482f6d0287d543f3a0e63eb21650c3c5ac6eeaa2717f8661d4725098b4dfb31a5605a479801885421dbb83e632d5117e27f0e06b9186729a664e9b1e16cedf52d10b9360e1ec0f9b9671d32333b03e9f11f696ef516173a857cfb5becffab6e6f2e25f1c30301fc9e06c739e8ea359f39c926a8660b116bbe0c89fa5d6d57d68626acea95710ffd2e6ca10bd4f61e44520d4ec54e263fd4a40d608afa1e258dfdc9e11b3572f61609f8cd33ccb0ad99d48192816e0af394205b48af69bfb700d815334def2f382745bc576e8c311a5aa8b92b44732f2711d6aeb76ab5548ca258b726eb9e9cd169be6ddb0d192a5d415f80746133000000d2000000000000000001000000fc7b3e3cc3d8b3026a04d6a239e65cf636b943458b0ad73563ab198633f3b12825e6cab496554fe315a85be40b6d26311620785110394b25de1c92a7ab3b02168ff62cf8d8bac650d8270cf6824806e0bd744b3e3fcc1b0eef8fb4628175eb473af6de862fc2c4b6ba07487d692539cb836109675a89601817b8c78474e2b7b7eb6a35f07592935ba71b923292b8f6b65aa4647b74305bff97073dc0ec2224fe4f6fcc1cd3faa048459d253ae9935b89939516c28ed11b966baa667619cfdcc2d5688eb742ead000ac5048ae858aca2e6aa43e00661562a47026fe88ff83992430204a159752c8335b630922a0c9dcfa6e4897abecafa3fa8dcd6bb624ef741e843522d34c4a3d547f4a26577c7300f955aeea36d65a9486b3e574f60d8203ee83a9073b288b"].into();
        assert_ok!(Zeropool::transact(owner(), deposit));

        let transfer = hex!["00000000237d9ab8ca165b7728b5353ee84423ee3ee44a71c535894a08dc2c476be4c321179204c43f1f98e74eab0c9e668c6e63bdb16907443a977e323dd3023602fb6e000000000080000000000000000000000000000000000000000000002d10fca86c5f882296870b3cee750134cc5af7fd10b5df5fe0c7b1a465b478b829e384af859d777e7ebf339ae7c21bc45bbe2da588d9af5f4f1b556f9a3263232af3fab5aa4f0df62236ecb7938482c862a32207aa397aa0ba0fae47841802e111af294acf087e6cdb385c944eb997a18154fbea9c3f4c34b98517d062ce664321c65349a1070a08a6824a195ca4ccc8f3a4ee73f4d55ce19ec626513b5684772df66f128fbfeadb4c43afa8b0133c0c98872d2f07fbd5d9abdaf6a7434ee227112747c3e3ab974996366e183cbba0dc98cbdb50b6f8f68832924695475a49c908123f64dde854f360a3a5ff30fe0802d9b26cf931f3d1356527efc9f240cc0229099ed53518664aa52c9cdeb77ebbea7616fa25506073d8d29162e5c73b916105d6c07495bdd93eb60a3dff79771a88baba6e7ad3f4bb4855e18bba78226f2b0f2db408d145faf5835fd11d6a12a18e159ffc4869b398849239259cd5f6b0a61d86ec7af5dad43bfccb9d20d4a9dc0b004760c8b7683bf3147783b1d4d2603c19a0829f443e907797acbda88bd31f67646b509ff2636fa554b4e30d95e3fff527f9cbce3cbaa8a58ad74ea2d1d549e2cfa2b8cd46a7ded72c39e6b752cf3a2f271fdb02f7e34d938bd5fe16d60786faa1addb87eabc153ad161eeaccf247d8e2a5aac24078162d70963760ca6221d35b00a41f9fe6643facb8ddac452a4fc8402dfa64efc00b497fc81884cc4820060b3fb809852d8445493c256ade00024070001017e0000000000000000020000002dedb8d83de8fd17b97a0c511bd8dfcbbf5a857c34c60c7b429d4dbf811aae28f627302e3a6384d3b7b97d571e9ccb8651f2405febfd9596bece416900684417730f108b1f1edba449c5a75cc27e4cf8486ea2a883561b1667ea1cd338eff42fae7b03ffdbafc43c8f2f3cea96cef62584bcda71768439882b78926602d20ac3523734ad517e701319d3984967ff6601760a726ef1d6b18476338ba321b0fd88088062ba8b8b78c751863c574a9618f4598c43d314f290bb3ee40a11a632600c34871f184450c7306e6904f4e737505043aed92bfa356689ce706a70d7ce8ac80d65a0a2877e36e980aad643b6423ae12ef414f665c018de9e15d0f03b9e3351cd55a134e8c0e8bd1cf8a37126f31f50f8a492d6f1c737bf81e1af3f98b300691c76983003053091f2007a0dce6bfa90c0219d78ce02ea0e05299565f5a9e2a4cf1347dc3ac33488f165f04f0171ca0070fd1fe19aeec1ce1ecbf306167cd09151f181b4be4c1e7e93bb4f430863333eab18"].into();
        assert_ok!(Zeropool::transact(owner(), transfer));

        let withdraw = hex!["000000002c985dbf440ba5d71866be3aab012bc487f32daf57f912c9efe3badd920c63db07b95d4d84ff468f72c226f8e0cec59e6f8d0b2af55a4a99f0c4335df79308840000000001000000000000000000000000000000ffffffffffd239401e76605d181bf056f5db4aeea7ab11f6f998cea56427fee2e0ab17e5f0593a701df6a9fec0f64939ddf60bc3a1a06a161074f30b97ffcdca95fb2082affae1ed08b0b51ccef92b2d29117c26f8471dc86db8f650b995eaeec4648ddded95a8650297b462124bc86c3f6875ebfd7c95860a7e6cb12041ca8eeb434f5c96f296b601548f068ce0d1d14e6a00f3866a32083bdce217480705c336a177ecac8295b712bbf5b47fb2475672c19e2f79429b668a815c18dfdbf569bc3031a8b97038a61a87c42985b6fad4c846320f8a02e0bf8defb9adfb4ba61213c32969cd8f0bad0690a04fdc795a4fa481784d39dd9b8e5e65db3247c3039a8b6864416cd562bb1216a80df8beb5b525f72c5d33640d4eadd0fe25faff6ab9d4302e1866876e7b0012b14735565d70674622aa29e7a16f4abf5c263c6f013eabb74955b66f12a4130ddda82bd8054d0768290629178f041cb97473fea93f9af3fc1af9b4c4667721c426b74da384c7c305b3a1db26687dc4f1ff1e914bb7b6aed2681c50e762a41dfe9e0e28c3e6625fcdb4cecd2b180d584214c5d3bb810890eba26ec3daf6c5142fea4c03b570a5690199cd71b0d1b3ccdcdef666ed9ddf6ada0b8803568aaa12af788940c776ed416e8f8171efbca512e835bc7d21bde98392436209657acc2015cc37828dc572a319e1ab69c0375281dc9834b604e04b07b796bbfa14418b09b3a8f848d37fc8a341b31a285945fdb6a33534fa76e15dffd65dd26728cec6000200fa00000000000000000000000000000000d000ac5048ae858aca2e6aa43e00661562a47026fe88ff83992430204a1597520100000002e3e0d869ad18376d317b73d4d56aeca73ec5eb2b8b43216a920e79403fae0783621edf3a8435f9be5acad4a0d945007be6b6131a6fe40333dea8f479511f02d56165f76d4fb9fc8a893e96744cab0801af7bc884afb4c9a20da401f7520ba10d68c950a097a96b3722bad97cc4d51998d02188d2fd74915e82e856559a03c0bc2f24a38ff500254f70923a5ffd8ce7843da20330db7057283de00ad2c663bc449b2d4d3e64dd66d22a42b8aaeddfae65a5b7714b069ca62ab37fac682a26437eaf4f81daa8"].into();
        assert_ok!(Zeropool::transact(owner(), withdraw));
    });
}
